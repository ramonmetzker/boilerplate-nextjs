#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo 'ğŸ—ï¸ğŸ‘· Estilizando, testando e compilando o projeto antes de realizar o commit'

# Valida os padrÃµes do Prettier
yarn check-format ||
(
  echo 'ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤® MEU DEUS! O seu cÃ³digo estÃ¡ feio!! ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤®
    A validaÃ§Ã£o do Prettier falhou. Execute yarn format, adicione as alteraÃ§Ãµes no git e tente o commit novamente.';
  false;
)

# Valida os padrÃµes do ESLint
yarn check-lint ||
(
  echo 'ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤ Quer quebrar as regras nÃ©, malandro?! ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤
      A validaÃ§Ã£o do ESLint falhou. FaÃ§a as alteraÃ§Ãµes listadas acima, adicione as alteraÃ§Ãµes no git e tente o commit novamente.'
  false; 
)

# Valida os padrÃµes Typescript
yarn check-types ||
(
  echo 'ğŸ¤¡ğŸ˜‚âŒğŸ¤¡ VocÃª nÃ£o passou na chacagem da tipagem ğŸ¤¡ğŸ˜‚âŒğŸ¤¡
    VocÃª realmente estÃ¡ tentando meter essa? FaÃ§a as alteraÃ§Ãµes listadas acima.'
  false;
)

# Se tudo passar... Podemos testar a build
echo 'ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”... Hmmm, ok... O cÃ³digo me parece bom... Tentando compilar agora. ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”'

yarn build ||
(
    echo 'âŒğŸ‘·ğŸ”¨âŒ Espero que nÃ£o esteja no fim do expediente... A build nÃ£o rolou âŒğŸ‘·ğŸ”¨âŒ
      A compilaÃ§Ã£o do Next falhou: Verifique os erros acima e descubra o motivo.'
    false;
)

# Se tudo passar... Agora podemos fazer o commit
echo 'âœ…âœ…âœ…âœ… VocÃª ganhou dessa vez... Vou commitar isso para vocÃª. âœ…âœ…âœ…âœ…'
